<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <title>Start Ribkix OS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="icon" href="https://ribkix.tk/ribkix-oc-corona.png">
  </head>
  <body onload="onLoad();">
    <header class="a-bypass">
     <nav>
      <div class="navbar-fixed">
        <div class="nav-wrapper ribdev-bgcolor">
          <ul class="left hide-on-med-and-down">
            <li><a class="waves-effect waves-light btn ribdev-bgcolor-dark" href="https://ribkix.tk/ribkix-os/home"><i class="material-icons">arrow_back</i></a></li>
          </ul>
          <a class="brand-logo center">Ribkix OS</a>
        </div>
      </div>
    </nav>
    </header>
    
    <main>
      <div id="modal1" class="modal" username_of_user="user">
        <div class="modal-content">
          <h4>Are you sure?</h4>
          <p id="modal1_p">Are you sure you want to delete "user"?</p>
        </div>
        <div class="modal-footer a-bypass">
          <a href="javascript:modal1_yes();" class="modal-close waves-effect waves-green btn-flat">Yes</a>
          <a class="modal-close btn ribdev-bgcolor white-fgcolor">Cancel</a>
        </div>
      </div>
      
      <center class="a-bypass">
        <h1>Start Ribkix OS</h1>
        <p>Select what to boot Ribkix OS in:</p>

        <ul class="collapsible" style="width:40%;">
          <li>
            <div class="collapsible-header">New User</div>
            <div class="collapsible-body">
              <div class="input-field">
                <input id="username" type="text" class="validate" value="user">
                <label for="username">Username</label>
              </div>

              <div class="input-field">
                <input id="password" type="password" class="validate">
                <label for="password">Password</label>
              </div>

              <div class="input-field">
                <input id="picture" type="text" class="validate" value="https://i.imgur.com/86j2Wsh.png">
                <label for="picture">Profile Picture (Image URL)</label>
              </div>

              <a class="waves-effect waves-light btn-small ribdev-bgcolor" id="preview_btn" href="javascript:preview();">CREATE</a>
         
              <div class="card" id="preview" style="width:125px;">
                <div class="card-image">
                  <img id="preview_image" src="https://i.imgur.com/86j2Wsh.png" width="125px" height="125px">
                </div>
                <div class="card-stacked">
                  <div class="card-content">
                    <h5 id="preview_content">user</h5>
                  </div>
                  <div class="card-action white-fgcolor">
                    <a class="waves-effect waves-light btn ribdev-bgcolor" href="javascript:create();">CREATE</a>
                  </div>
                </div>
              </div>
            </div>
          </li>
          <li>
            <div class="collapsible-header">Load User</div>
            <div class="collapsible-body" id="load_user_list">
              <script>
                function load_user(un){
                  window.location.href = "https://ribkix.tk/ribkix-os/boot?user=user-" + un;
                }
                
                function delete_user(un,btn){
                  var modal = document.getElementById("modal1");
                  modal.username_of_user = un;
                  modal.button_from_fired = btn;
                  document.getElementById("modal1_p").innerHTML = 'Are you sure you want to delete "' + un + '"?'
                  
                  var instance = M.Modal.init(modal);
                  instance.open();
                }
                
                function add_user_to_load(un,pw,pic,a){
                  var l = document.getElementById("load_user_list");
                  
                  var card = document.createElement("DIV");
                  card.id = "card-load-user-" + un;
                  card.classList.add("card");
                  card.style = "width:125px;";
                  l.appendChild(card);
                  
                  var card_image = document.createElement("DIV");
                  card_image.classList.add("card-image");
                  card.appendChild(card_image);
                  
                  var img = document.createElement("IMG");
                  img.src = pic;
                  img.style = "width:125px;height:125px;";
                  card_image.appendChild(img);
                  
                  var card_stacked = document.createElement("DIV");
                  card_stacked.classList.add("card-stacked");
                  card.appendChild(card_stacked);
                  
                  var card_content = document.createElement("DIV");
                  card_content.classList.add("card-content");
                  card_stacked.appendChild(card_content);
                  
                  var h5 = document.createElement("H5");
                  h5.innerHTML = un;
                  card_content.appendChild(h5);
                  
                  var card_action = document.createElement("DIV");
                  card_action.classList.add("card-action");
                  card_action.classList.add("white-fgcolor");
                  card.appendChild(card_action);
                  
                  var a = document.createElement("A");
                  a.classList.add("waves-effect");
                  a.classList.add("waves-light");
                  a.classList.add("btn");
                  a.classList.add("ribdev-bgcolor");
                  a.href = "javascript:load_user('" + un + "');";
                  a.innerHTML = "LOAD";
                  card_action.appendChild(a);
                  
                  var br = document.createElement("BR");
                  card_action.appendChild(br);
                  
                  var br2 = document.createElement("BR");
                  card_action.appendChild(br2);
                  
                  var a2 = document.createElement("A");
                  a2.classList.add("waves-effect");
                  a2.classList.add("waves-light");
                  a2.classList.add("btn");
                  a2.classList.add("ribdev-bgcolor");
                  a2.href = "javascript:delete_user('" + un + "','" + card.id + "');";
                  a2.innerHTML = "DELETE";
                  card_action.appendChild(a2);
                }
                
                for (var i=0;i<localStorage.length;i++){
                  eval("add_user_to_load(" + localStorage.getItem(localStorage.key(i)).substring(10));
                }
              </script>
            </div>
          </li>
        </ul>
      </center>
    
      <br>
    </main>
    
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>
      function onLoad(){
        document.getElementById("preview").style.display = "none";
      }
      
      function modal1_yes(){
        var modal = document.getElementById("modal1");
        console.log("Delete " + localStorage.getItem("user-" + modal.username_of_user));
        localStorage.removeItem("user-" + modal.username_of_user);
        modal.button_from_fired.remove();
      }
      
      function preview(){
        if (document.getElementById("preview").style.display === "none"){
          document.getElementById("preview_image").src = document.getElementById("picture").value;
          document.getElementById("preview_content").innerHTML = document.getElementById("username").value;
          document.getElementById("preview").style.display = "block";
          document.getElementById("preview_btn").innerHTML = "CANCEL";
        } else {
          document.getElementById("preview").style.display = "none";
          document.getElementById("preview_btn").innerHTML = "CREATE";
        }
      }
      
      function create(){
        var username = document.getElementById("username").value;
        var password = document.getElementById("password").value;
        var picture = document.getElementById("picture").value;
        var apps = [];
        
        if (!localStorage.getItem("user-" + username)){
          localStorage.setItem("user-" + username,"load_user('" + username + "','" + password + "','" + picture + "',[" + apps.toString() + "])");
          M.toast({html:'"' + username + '" has been created!',completeCallback:window.location.href = "https://ribkix.tk/ribkix-os/boot?user=user-" + username});
        } else {
          M.toast({html:'"' + username + '" already exists!'})
        }
      }
      
      $(document).ready(function(){
        $('.collapsible').collapsible();
      });
    </script>
  </body>
</html>
<style>
  /* CUSTOM CSS */
  
  .a-bypass a {
    text-decoration: none !important;
  }
  
  .a-bypass a:hover {
    color: white !important;
    text-decoration: none !important;
  }
  
  /* END */
    
  /* COLORS */
  
  .ribdev-bgcolor {
    background-color: #0270d7 !important;
  }
  .ribdev-bgcolor-dark {
    background-color: #00509c !important;
  }
  .ribdev-fgcolor {
    color: #0270d7 !important;
  }
  
  .white-fgcolor {
    color: white !important;
  }
  /* END */
</style>
